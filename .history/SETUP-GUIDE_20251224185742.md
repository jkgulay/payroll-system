# Construction Payroll System - Setup Guide

## Prerequisites

### Required Software

- **PHP**: 8.1 or higher
- **Composer**: 2.x
- **PostgreSQL**: 14 or higher
- **Node.js**: 18 or higher
- **npm**: 9 or higher

### Optional

- **pgAdmin 4**: For database management
- **Postman**: For API testing

---

## Backend Setup (Laravel)

### Step 1: Install Dependencies

```bash
cd backend
composer install
```

### Step 2: Environment Configuration

```bash
# Copy environment file
cp .env.example .env

# Generate application key
php artisan key:generate
```

### Step 3: Configure Database

Edit `.env` file:

```env
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=construction_payroll
DB_USERNAME=postgres
DB_PASSWORD=your_password_here
```

### Step 4: Create Database

```bash
# Using psql
psql -U postgres
CREATE DATABASE construction_payroll;
\q
```

Or use pgAdmin to create the database.

### Step 5: Run Migrations

```bash
php artisan migrate
```

### Step 6: Seed Database (Optional)

```bash
php artisan db:seed
```

This will create:

- Default admin user (admin@construction.com / password)
- Sample departments and locations
- Government contribution tables with 2025 rates
- Sample holidays

### Step 7: Start Development Server

```bash
php artisan serve
```

API will be available at `http://localhost:8000`

---

## Frontend Setup (Vue 3 + Vuetify)

### Step 1: Install Dependencies

```bash
cd frontend
npm install
```

### Step 2: Environment Configuration

Create `.env.local` file:

```env
VITE_APP_NAME="Construction Payroll System"
VITE_API_URL=http://localhost:8000/api
VITE_APP_VERSION=1.0.0
```

### Step 3: Start Development Server

```bash
npm run dev
```

Frontend will be available at `http://localhost:3000`

---

## Database Schema Overview

### Core Tables

- `users` - System users (admin, accountant, employee)
- `employees` - Employee master data
- `departments` - Company departments
- `locations` - Construction sites/locations
- `attendance` - Daily attendance records
- `payroll` & `payroll_items` - Payroll processing
- `payroll_item_details` - Detailed earnings/deductions

### Employee Benefits

- `employee_allowances` - Water, COLA, incentives, etc.
- `employee_bonuses` - Performance bonuses
- `employee_deductions` - PPE, tools, etc.
- `employee_loans` - Company loans and advances

### Government Compliance

- `sss_contribution_table` - SSS rates
- `philhealth_contribution_table` - PhilHealth rates
- `pagibig_contribution_table` - Pag-IBIG rates
- `tax_withholding_table` - BIR tax tables

### Recruitment

- `applicants` - Job applicants
- `applicant_documents` - Resumes, IDs

### Configuration

- `holidays` - Philippine holidays
- `company_settings` - Company information
- `audit_logs` - System audit trail

---

## Default Login Credentials

### Admin Account

- **Email**: admin@construction.com
- **Password**: password
- **Role**: Admin (full access)

### Accountant Account

- **Email**: accountant@construction.com
- **Password**: password
- **Role**: Accountant (payroll, reports)

### Sample Employee

- **Email**: employee001@construction.com
- **Password**: password
- **Role**: Employee (view own data)

**⚠️ IMPORTANT: Change these passwords immediately after first login!**

---

## API Endpoints

### Authentication

```
POST   /api/auth/login
POST   /api/auth/logout
GET    /api/auth/me
```

### Employees

```
GET    /api/employees
POST   /api/employees
GET    /api/employees/{id}
PUT    /api/employees/{id}
DELETE /api/employees/{id}
```

### Attendance

```
GET    /api/attendance
POST   /api/attendance
GET    /api/attendance/employee/{employee_id}
```

### Payroll

```
GET    /api/payroll
POST   /api/payroll
GET    /api/payroll/{id}
POST   /api/payroll/{id}/process
POST   /api/payroll/{id}/approve
GET    /api/payroll/{id}/items
```

Full API documentation available at `/api/documentation` (after installing Swagger)

---

## Project Structure

```
construction-payroll/
├── backend/                    # Laravel API
│   ├── app/
│   │   ├── Http/
│   │   │   ├── Controllers/
│   │   │   ├── Requests/
│   │   │   └── Resources/
│   │   ├── Models/
│   │   ├── Services/          # Business logic
│   │   ├── Repositories/      # Data access
│   │   └── Jobs/              # Background jobs
│   ├── database/
│   │   ├── migrations/
│   │   └── seeders/
│   └── config/
│
├── frontend/                   # Vue 3 + Vuetify
│   ├── src/
│   │   ├── components/
│   │   ├── views/
│   │   ├── stores/            # Pinia state management
│   │   ├── services/          # API clients
│   │   ├── router/
│   │   └── db/                # IndexedDB (offline)
│   └── electron/              # Desktop wrapper
│
└── docs/                       # Documentation
    ├── 01-SYSTEM-ARCHITECTURE.md
    ├── 02-DATABASE-SCHEMA.md
    ├── 03-API-STRUCTURE.md
    ├── 04-FRONTEND-STRUCTURE.md
    ├── 05-PAYROLL-COMPUTATION.md
    └── 06-DEVELOPMENT-ROADMAP.md
```

---

## Testing

### Backend Tests

```bash
cd backend
php artisan test
```

### Frontend Tests

```bash
cd frontend
npm run test
```

---

## Building for Production

### Backend

```bash
cd backend
composer install --optimize-autoloader --no-dev
php artisan config:cache
php artisan route:cache
php artisan view:cache
```

### Frontend (Web)

```bash
cd frontend
npm run build
```

### Desktop App (Electron)

```bash
cd frontend
npm run electron:build
```

This will create installers for Windows/Mac/Linux in `frontend/dist_electron/`

---

## Maintenance Tasks

### Update Government Contribution Tables

1. Login as Admin
2. Navigate to Settings → Contribution Tables
3. Select table to update (SSS, PhilHealth, Pag-IBIG, Tax)
4. Add new rate with effective date
5. Old rates are automatically archived

### Database Backup

```bash
# Backup
pg_dump -U postgres construction_payroll > backup_$(date +%Y%m%d).sql

# Restore
psql -U postgres construction_payroll < backup_20250101.sql
```

### Update Application

```bash
# Backend
cd backend
git pull
composer install
php artisan migrate
php artisan cache:clear

# Frontend
cd frontend
git pull
npm install
npm run build
```

---

## Troubleshooting

### Database Connection Error

- Verify PostgreSQL is running
- Check `.env` credentials
- Ensure database exists

### Migration Error

- Check database permissions
- Run `php artisan migrate:fresh` (⚠️ destroys data)
- Check migration files for syntax errors

### Frontend Not Loading

- Check API URL in `.env.local`
- Verify backend is running
- Clear browser cache

### Payroll Calculation Wrong

- Verify contribution tables are up to date
- Check employee basic rate
- Review attendance records
- Check audit logs for manual edits

---

## Production Deployment

### Server Requirements

- **OS**: Ubuntu 20.04 LTS or Windows Server 2019+
- **RAM**: 4GB minimum, 8GB recommended
- **Storage**: 50GB minimum
- **Database**: PostgreSQL 14+ (can be on same or separate server)

### Deployment Checklist

- [ ] Set up production server
- [ ] Install PHP, Composer, PostgreSQL
- [ ] Configure SSL certificate
- [ ] Set up Nginx/Apache web server
- [ ] Deploy Laravel backend
- [ ] Build and deploy Vue frontend
- [ ] Configure environment variables
- [ ] Run migrations
- [ ] Seed contribution tables
- [ ] Create admin user
- [ ] Set up automatic backups
- [ ] Configure monitoring and logging
- [ ] Test all functionality
- [ ] Train users

### Desktop Deployment

- [ ] Build Electron app
- [ ] Code sign the installer (recommended)
- [ ] Distribute to user machines
- [ ] Configure API endpoint
- [ ] Test offline functionality

---

## Support

### Documentation

- System Architecture: `docs/01-SYSTEM-ARCHITECTURE.md`
- Database Schema: `docs/02-DATABASE-SCHEMA.md`
- API Reference: `docs/03-API-STRUCTURE.md`
- Payroll Logic: `docs/05-PAYROLL-COMPUTATION.md`

### Common Issues

- Check `storage/logs/laravel.log` for backend errors
- Check browser console for frontend errors
- Review audit logs for data changes

---

## License

Proprietary - Construction Company Inc.

---

## Version

Current Version: 1.0.0
Last Updated: December 24, 2025
